# Excel Loan Calculation Report Guide

## ğŸ“Š **Overview**
The Excel report generator creates a detailed day-by-day calculation report for any loan, covering 6 months (180 days) from the loan creation date.

## ğŸ“ **How to Generate**
1. Go to **Admin Dashboard** â†’ **All Loans**
2. Click on any loan to view details
3. Click the **"Download Excel Report"** button (green button with Excel icon)
4. The Excel file will download automatically

## ğŸ“‘ **Report Structure**

### **Sheet 1: With Payments (Actual)**
Shows the actual loan calculations including all verified payments.

**Columns:**
- **Day**: Day number (1-180)
- **Date**: Calendar date
- **Opening Principal**: Principal amount at start of day
- **Daily Interest**: Interest accrued for that day
- **Accumulated Interest**: Total interest accumulated from loan start
- **Payment Amount**: Total payment made on that day
- **Interest Paid**: Portion of payment that went to interest
- **Principal Paid**: Portion of payment that went to principal
- **Closing Principal**: Principal amount at end of day
- **Remaining Interest**: Accumulated interest remaining after payment

**Features:**
- âœ… Payment rows are **highlighted in yellow**
- âœ… All amounts formatted as currency (â‚¹)
- âœ… Shows how each payment reduces interest and principal

### **Sheet 2: Without Payments (Projection)**
Shows what the loan would look like with NO payments made.

**Columns:**
- **Day**: Day number (1-180)
- **Date**: Calendar date
- **Opening Principal**: Principal amount (never changes)
- **Daily Interest**: Interest accrued for that day
- **Accumulated Interest**: Total interest accumulated from loan start
- **Closing Principal**: Principal amount (same as opening)
- **Remaining Interest**: Same as accumulated interest

**Purpose:**
- ğŸ“ Manual verification and calculation checks
- ğŸ“ Compare "what if" scenarios
- ğŸ“ Fill in your own calculations to verify system accuracy

## ğŸ§® **Calculation Method**

### **Interest Calculation**
- **Daily Rate** = Annual Rate Ã· 360 days Ã· 100
- **Daily Interest** = Opening Principal Ã— Daily Rate
- **Accumulated Interest** = Sum of all daily interest minus interest paid

### **Payment Allocation (Regular Loans)**
1. **First**: Pay accumulated interest
2. **Then**: Remainder goes to principal
3. Principal only reduces after accumulated interest is paid

### **Example**
Loan: â‚¹200,000 @ 21% annual
- Day 43: Accumulated interest = â‚¹5,016.67
- Payment: â‚¹5,000
- **Allocation**: â‚¹5,000 to interest, â‚¹0 to principal
- Remaining interest: â‚¹16.67

## ğŸ“ˆ **Use Cases**

### **For Admins**
- âœ… Verify loan calculations
- âœ… Explain to customers how their payments are allocated
- âœ… Track interest accumulation over time
- âœ… Audit payment processing

### **For Verification**
- âœ… Compare Sheet 1 (actual) vs Sheet 2 (projection)
- âœ… Manually calculate in Sheet 2 and verify against system
- âœ… Check payment allocation logic
- âœ… Verify interest calculation accuracy

## ğŸ¨ **Report Features**

1. **Summary Section** (Top of each sheet)
   - Loan name
   - Customer name
   - Principal amount
   - Interest rate
   - Loan creation date

2. **Professional Formatting**
   - Headers with blue background
   - Currency formatting (â‚¹)
   - Borders for all cells
   - Yellow highlights for payment rows
   - Proper column widths

3. **Two Sheets for Comparison**
   - "With Payments": Shows actual scenario
   - "Without Payments": Shows projection scenario

## ğŸ’¡ **Tips**

1. **Download regularly** to track loan progress over time
2. **Use Sheet 2** to manually verify calculations
3. **Look for yellow rows** in Sheet 1 to see when payments were made
4. **Compare accumulated interest** between sheets to see payment impact
5. **File is named with timestamp** so you can track historical reports

## ğŸ”§ **Technical Details**

- **Report Period**: 180 days (6 months)
- **Interest Basis**: 360 days per year
- **Payment Source**: Only verified payments are included
- **Date Range**: From loan creation date + 180 days
- **File Format**: Excel (.xlsx)
- **File Size**: ~50-100 KB per report

## â“ **FAQ**

**Q: Why 180 days?**
A: 6 months provides a good balance between detailed tracking and file size.

**Q: Can I extend the period?**
A: Yes, contact your system administrator to modify the `num_days` parameter.

**Q: Why are some rows yellow?**
A: Yellow rows indicate days when payments were made.

**Q: What if a payment was made but isn't showing?**
A: Only **verified** payments are included. Pending payments are not shown.

**Q: Can I edit the Excel file?**
A: Yes! Sheet 2 is specifically designed for manual calculations and verification.

---

**Generated by Lending Management System**
**Version: 2.1.0**

